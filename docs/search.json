[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Comparing Treatments for Amblyopia with a Synaptic Plasticity Model",
    "section": "",
    "text": "These notes are produced with Quarto. (https://quarto.org/docs/books)\n\n\nThe software is Python-based with parts written in Cython.\n\nDownload the Anaconda Distribution of Python:\n\nhttps://www.anaconda.com/products/individual#downloads\n\nDownload and extract the PlasticNet package at:\n\nhttps://github.com/bblais/Plasticnet/archive/refs/heads/master.zip\n\nRun the script install.py\n\n\n\n\nPrintable versions of this report can be found on the GitHub site for this project,\n\nMicrosoft Word version\nPDF version"
  },
  {
    "objectID": "Introduction.html",
    "href": "Introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "In this part we will explore the clinical basis for amblyopia and its treatments. In the Chapter 4 and Chapter 5 we will explore the models that are used to describe the deficits from amblyopia and their treatment, respectively."
  },
  {
    "objectID": "Amblyopia.html",
    "href": "Amblyopia.html",
    "title": "1  What is Amblyopia?",
    "section": "",
    "text": "Amblyopia is the most common cause of vision loss in children, caused by refractive errors or misalignment of the eyes (Zárate and Tejedor 2007)."
  },
  {
    "objectID": "Amblyopia.html#how-is-it-treated",
    "href": "Amblyopia.html#how-is-it-treated",
    "title": "1  What is Amblyopia?",
    "section": "1.1 How is it Treated?",
    "text": "1.1 How is it Treated?\nThe current primary treatment is described in the Amblyopia Preferred Practice Method (Wallace et al. 2018). Treatments are divided into two broad categories, monocular and binocular treatments. Monocular treatments produce a competition between the two eyes by treating only the fellow eye to that the amblyopic eye recovers. Binocular treatments seek to stimulate both eyes in such a way that binocular mechanisms can produce a recovery in the amblyopic eye.\n\n1.1.1 Monocular Treatments\nThe most common treatment includes\n\nthe optical correction of significant refractive errors\npatching the dominant eye which forces the visual input to come from only the amblyopic eye.\n\nAlthough patching is the most common method of treatment, other methods are described including pharmacology and technology (Jonathan M. Holmes et al. 2016b; Kelly et al. 2016; Jonathan M. Holmes et al. 2016a; Li et al. 2015; Zárate and Tejedor 2007; Gao et al. 2018; Glaser et al. 2002). These include,\n\nPharmacological treatment with atropine drops in the fellow eye\n\nEach of these treatments only directly applies to the fellow eye and the amblyopic eye is left untouched.\n\n\n1.1.2 Binocular Treatments\nThere are some treatments which are administered to both eyes, making them binocular treatments. The one that we will be addressing here use virtual reality headsets(Xiao et al. 2020, 2022),\n\nVirtual reality input to both eyes, with contrast modification and/or dichoptic masks"
  },
  {
    "objectID": "Amblyopia.html#mechanisms-for-amblyopia",
    "href": "Amblyopia.html#mechanisms-for-amblyopia",
    "title": "1  What is Amblyopia?",
    "section": "1.2 Mechanisms for Amblyopia",
    "text": "1.2 Mechanisms for Amblyopia\nSince the unequal visual input to the brain can cause alterations in the synaptic pathways leading to a disparity in ocular dominance (Birch 2013), it is important to understand the possible synaptic effects amblyopia can produce and how potential treatments will either help or hinder the recovery.\n\n\n\n\nBirch, Eileen E. 2013. “Amblyopia and Binocular Vision.” Progress in Retinal and Eye Research 33: 67–84.\n\n\nGao, Tina Y., Cindy X. Guo, Raiju J. Babu, Joanna M. Black, William R. Bobier, Arijit Chakraborty, Shuan Dai, et al. 2018. “Effectiveness of a Binocular Video Game Vs Placebo Video Game for Improving Visual Functions in Older Children, Teenagers, and Adults with Amblyopia.” JAMA Ophthalmology 136 (2): 172. https://doi.org/10.1001/jamaophthalmol.2017.6090.\n\n\nGlaser, Stephen R, Andrea M Matazinski, David M Sclar, Nicholas A Sala, Chrissy M Vroman, Cindy E Tanner, David R Stager, et al. 2002. “A Randomized Trial of Atropine Vs Patching for Treatment of Moderate Amblyopia in Children.” Archives of Ophthalmology 120 (3): 268–78.\n\n\nHolmes, Jonathan M., Vivian M. Manh, Elizabeth L. Lazar, Roy W. Beck, Eileen E. Birch, Raymond T. Kraker, Eric R. Crouch, et al. 2016a. “Effect of a Binocular iPad Game Vs Part-Time Patching in Children Aged 5 to 12 Years with Amblyopia.” JAMA Ophthalmology 134 (12): 1391. https://doi.org/10.1001/jamaophthalmol.2016.4262.\n\n\nHolmes, Jonathan M, Vivian M Manh, Elizabeth L Lazar, Roy W Beck, Eileen E Birch, Raymond T Kraker, Eric R Crouch, et al. 2016b. “A Randomized Trial of a Binocular iPad Game Versus Part-Time Patching in Children 5 to 12 Years of Age with Amblyopia.” JAMA Ophthalmology 134 (12): 1391.\n\n\nKelly, Krista R., Reed M. Jost, Lori Dao, Cynthia L. Beauchamp, Joel N. Leffler, and Eileen E. Birch. 2016. “Binocular iPad Game Vs Patching for Treatment of Amblyopia in Children.” JAMA Ophthalmology 134 (12): 1402. https://doi.org/10.1001/jamaophthalmol.2016.4224.\n\n\nLi, Simone L, Alexandre Reynaud, Robert F Hess, Yi-Zhong Wang, Reed M Jost, Sarah E Morale, Angie De La Cruz, Lori Dao, David Stager Jr, and Eileen E Birch. 2015. “Dichoptic Movie Viewing Treats Childhood Amblyopia.” J AAPOS 19 (5): 401–5. https://doi.org/10.1016/j.jaapos.2015.08.003.\n\n\nWallace, David K, Michael X Repka, Katherine A Lee, Michele Melia, Stephen P Christiansen, Christie L Morse, and Derek T Sprunger. 2018. “Amblyopia Preferred Practice Pattern.” Ophthalmology 125 (1): P105–42.\n\n\nXiao, Scott, Endri Angjeli, Hank C Wu, Eric D Gaier, Stephanie Gomez, Dean A Travers, Gil Binenbaum, et al. 2022. “Randomized Controlled Trial of a Dichoptic Digital Therapeutic for Amblyopia.” Ophthalmology 129 (1): 77–85.\n\n\nXiao, Scott, Eric D Gaier, Malcolm L Mazow, Ann U Stout, Dean A Travers, Endri Angjeli, Hank C Wu, Gil Binenbaum, and David G Hunter. 2020. “Improved Adherence and Treatment Outcomes with an Engaging, Personalized Digital Therapeutic in Amblyopia.” Scientific Reports 10 (1): 1–8.\n\n\nZárate, Blanca Ruiz de, and Jaime Tejedor. 2007. “Current Concepts in the Management of Amblyopia.” Clinical Ophthalmology (Auckland, NZ) 1 (4): 403."
  },
  {
    "objectID": "Methods.html",
    "href": "Methods.html",
    "title": "Methods",
    "section": "",
    "text": "Bienenstock, E. L., L. N Cooper, and P. W. Munro. 1982. “Theory for the Development of Neuron Selectivity: Orientation Specificity and Binocular Interaction in Visual Cortex.” Journal of Neuroscience 2: 32–48."
  },
  {
    "objectID": "Natural Image Environment.html",
    "href": "Natural Image Environment.html",
    "title": "2  Natural Image Input Environment",
    "section": "",
    "text": "Code\n%matplotlib inline\nfrom input_environment_defs import *\nIn order to approximate the visual system, we start with the following basic properties of the retina, LGN and cortex. There are approximately 1000 photoreceptors feeding into 1 ganglion cell (Jeon, Strettoi, and Masland 1998; Sterling, Freed, and Smith 1988). The retina/LGN responses show a center-surround organization, but with a center diameter less than 1\\(^o\\) (Hubel 1995)\nWe use natural scene stimuli for the simulated inputs to the visual system. We start with images taken with a digital camera, with dimensions 1200 pixels by 1600 pixels and 40\\(^o\\) by 60\\(^o\\) real-world angular dimensions (Figure Figure 2.1). Photoreceptors have a logarithmic response to the stimulus, so we apply the natural logarithm to the pixel values. Finally, we model the ganglion responses using a 32x32 pixel center-surround difference-of-Gaussians (DOG) filter to process the images, each pixel representing one photoreceptor (Figure Figure 2.2). The center-surround radius ratio used for the ganglion cell is 1:3, with balanced excitatory and inhibitory regions and normalized Gaussian profiles."
  },
  {
    "objectID": "Natural Image Environment.html#two-eye-architecture",
    "href": "Natural Image Environment.html#two-eye-architecture",
    "title": "2  Natural Image Input Environment",
    "section": "2.1 Two-eye architecture",
    "text": "2.1 Two-eye architecture\nShown in Figure Figure 2.3 is the visual field, approximated here as a two-dimensional projection, to left and right retinal cells. These left and right retinal cells project to the left and right LGN cells, respectively, and finally to a single cortical cell. The LGN is assumed to be a simple relay, and does not modify the incoming retinal activity. It is important to understand that the model we are pursuing here is a single cortical cell which receives input from both eyes. We will encounter some limitations to this model which may necessitate exploring multi-neuron systems.\nIn the model, normal development is simulated with identical image patches presented to both eyes combined with small independent noise in each eye. The random noise is generated from a zero-mean normal distribution of a particular variance, representing the natural variation in responses of LGN neurons. Practically, the independent random noise added to each of the two-eye channels avoids the artificial situation of having mathematically identical inputs in the channels. The development of the deficit and the subsequent treatment protocols are modeled with added preprocessing to these image patches, described later in Chapter 4 and Chapter 5.\nFor all of the simulations we use a 19x19 receptive field, which is a compromise between speed of simulation and the limits of spatial discretization. We perform at least 20 independent simulations for each condition to address variation in the results.\n\n\n\nFigure 2.3: Two-eye Architecture.\n\n\n\n\nCode\nsim,X=get_input_patch_examples(blur=-1)\nims=inputs_to_images(X,buffer=2)\nfigure(figsize=(20,6))\nfor i in range(24):\n    im=ims[i]\n    subplot(4,6,i+1)\n    imshow(im,cmap=plt.cm.gray)\n    axis('off')\n    \n\n\n\n\n\nFigure 2.4: A sample of 24 input patches from a normal visual environment. The left- and right-eye inputs are shown in pairs.\n\n\n\n\n\n\n\n\nHubel, David H. 1995. Eye, Brain, and Vision. Scientific American Library/Scientific American Books.\n\n\nJeon, C J, E Strettoi, and R H Masland. 1998. “The major cell populations of the mouse retina.” J Neurosci 18 (21): 8936–46.\n\n\nSterling, P, M A Freed, and R G Smith. 1988. “Architecture of rod and cone circuits to the on-beta ganglion cell.” J Neurosci 8 (2): 623–42."
  },
  {
    "objectID": "Synaptic Modification.html",
    "href": "Synaptic Modification.html",
    "title": "3  Synaptic Modification",
    "section": "",
    "text": "Code\n%matplotlib inline\nfrom input_environment_defs import *\nfrom deficit_defs import Results"
  },
  {
    "objectID": "Synaptic Modification.html#the-bcm-learning-rule",
    "href": "Synaptic Modification.html#the-bcm-learning-rule",
    "title": "3  Synaptic Modification",
    "section": "3.1 The BCM Learning Rule",
    "text": "3.1 The BCM Learning Rule\nWe use a single neuron and the parabolic form of the BCM(Bienenstock, Cooper, and Munro 1982; Brian S. Blais et al. 2008) learning rule for all of the simulations, where the synaptic modification depends on the postsynaptic activity, \\(y\\), in the following way for a single neuron\n\\[\ny=\\sigma\\left(\\sum_i x_i w_i \\right)\n\\] \\[\n\\frac{dw_i}{dt} = \\eta y(y-\\theta_M) x_i\n\\] \\[\n\\frac{d\\theta_M}{dt} = (y^2-\\theta_M)/\\tau\n\\]\nwhere is \\(x_i\\) is the \\(i\\)th presynaptic input, \\(w_i\\) is the \\(i\\)th synaptic weight, and \\(y\\) is the postsynaptic output activity. The constant, \\(\\eta\\), refers to the learning rate and the constant, \\(\\tau\\), is what we call the memory-constant and is related to the speed of the sliding threshold. The transfer function, \\(\\sigma(\\cdot)\\), places minimum and maximum responses given a set of inputs and weights.\n\n\nCode\ny=np.linspace(-5,20,100)\nθ_M=8\nϕ=y*(y-θ_M)\n\nplot(y,ϕ,'b-')\n\nyl=gca().get_ylim()\nplot([0,0],yl,'k--')\ngca().set_ylim(yl)\n\nxl=gca().get_xlim()\nplot(xl,[0,0],'k--')\ngca().set_xlim(xl)\n\nplt.text(θ_M,30,r'$\\theta_M$',ha='center',va='center')\nplt.arrow(θ_M+1,30,5,0,color='r',length_includes_head=True,\n              head_width=5, head_length=.6,lw=2)\nplt.arrow(θ_M-1,30,-5,0,color='r',length_includes_head=True,\n              head_width=5, head_length=.6,lw=2)\nplot([θ_M,θ_M],[-10,10],'r-',lw=2)\nxlabel('Neuron output ($y$)')\nylabel('Change in the synaptic weight ($dw/dt$)');\n\n\n\n\n\nFigure 3.1: The BCM synaptic modification function. Units are arbitrary.\n\n\n\n\nThe results are extremely robust to values of \\(\\eta\\) and \\(\\tau\\) , which are generally chosen for practical, rather than theoretical, considerations. Each of these constants is related to the time-step for the simulations, but given the phenomenological nature of the BCM theory it is beyond the scope of this paper to make detailed comparisons between simulation time and real-time. Further, the fact that \\(\\tau\\) can be changed within a factor of 100 with no noticeable effect, the experiments presented here cannot be used address the time-scales of the molecular mechanisms underlying synaptic modification. Whenever we refer to real-time units for a simulation, we approximate a single simulation iteration as 1 iteration = 0.2 seconds(Brian S. Blais 1998).\nIn the BCM learning rule, weights decrease if \\(y\\) is less than the modification threshold,\\(\\theta_M\\) , and increase if \\(y\\) is greater than the modification threshold. To stabilize learning, the modification threshold “slides” as a super-linear function of the output. The output, \\(y\\) , is related to the product of the inputs and the weights via a sigmoidal function, \\(\\sigma(\\cdot)\\), which places constraints on the values of the output, keeping it in the range -1 and 50. The interpretation of negative values is consistent with previous work(B. S. Blais et al. 1998), where the activity values are measured relative to spontaneous activity. Thus, negative values are interpreted as activity below spontaneous. We continue this usage, in order to more easily compare with previous simulations. The role of the spontaneous level for the simulations in the natural image environment is discussed elsewhere(B. S. Blais et al. 1998)."
  },
  {
    "objectID": "Synaptic Modification.html#simulation",
    "href": "Synaptic Modification.html#simulation",
    "title": "3  Synaptic Modification",
    "section": "3.2 Simulation",
    "text": "3.2 Simulation\nThe synaptic weights, and the modification threshold, are set to small random initial values at the beginning of a simulation. At each iteration, an input patch is generated as described above depending on the procedure being simulated and then presented to the neuron. After each input patch is presented, the weights are modified using the output of the neuron, the input values and the current value of the modification threshold. In an input environment composed of patches taken from natural images, with equal patches presented to the left- and right-eyes as shown in Figure 2.4, this process orientation selective and fully binocular cells(B. S. Blais et al. 1998). We then present test stimulus made from sine-gratings with 24 orientations, 20 spatial frequencies, and optimized over phase. Applying any of the blur filters to the sine gratings does not quantitatively change the result.\n\n\nCode\nfname=pi5.filtered_images('asdf/bbsk081604_all_log2dog.asdf')\n\npre1=pn.neurons.natural_images(fname,\n                               rf_size=19,verbose=False)\n\npre2=pn.neurons.natural_images(fname,rf_size=19,\n                            other_channel=pre1,\n                            verbose=False)\n\npre1+=pn.neurons.process.add_noise_normal(0,0.5) # a little noise\npre2+=pn.neurons.process.add_noise_normal(0,0.5) # a little noise\n\n\npre=pre1+pre2\n\nnumber_of_neurons=5\npost=pn.neurons.linear_neuron(number_of_neurons)\npost+=pn.neurons.process.sigmoid(0,50)\n\nc=pn.connections.BCM(pre,post,[-.01,.01],[.1,.2])\nc+=pn.connections.process.orthogonalization(10*minute)\nc.eta=2e-6\nc.tau=15*minute   \n\nsim=pn.simulation(4*day)\nsim.dt=200*ms\n\nsave_interval=30*minute\nsim.monitor(post,['output'],save_interval)\nsim.monitor(c,['weights','theta'],save_interval)\n\nsim+=pn.grating_response()\n\npn.run_sim(sim,[pre,post],[c],display_hash=True,print_time=True)\npn.save('sims/nr.asdf',sim,[pre,post],[c])\nR=Results('sims/nr.asdf')\n\n\n\n\nCode\ndef argmax_rc(X):\n    \"\"\"Return the row and col of the maximum value\"\"\"\n    r,c=np.unravel_index(np.argmax(X), X.shape)\n    return r,c\n\n\n\n\nCode\nfigure(figsize=(4,10))\nR.plot_rf()\n\nfigure(figsize=(10,8))\nplot(R.t/hour,R.θ,label=[f'Neuron {i}' for i in [0,1,2,3,4]])\nylabel(r'$\\theta_M$')\nxlabel('Time (hours)')\nlegend();\n\nfigure(figsize=(10,8))\nt,y=R.all_responses[0]\nfor neuron in range(5):\n    subplot(2,1,1)\n    y_left=y[:,:,0,neuron,-1]  \n    y_right=y[:,:,1,neuron,-1]  \n    \n    r,c=argmax_rc(y_left)\n    tuning_curve=y_left[r,:]    \n    plot(R.theta_mat,tuning_curve,'-o')\n    plt.title('Left-eye Responses')\n    ylabel('Response')\n    gca().set_xticklabels([])\n    \n    subplot(2,1,2)\n    r,c=argmax_rc(y_right)\n    tuning_curve=y_right[r,:]\n    plot(R.theta_mat,tuning_curve,'-s')    \n    plt.title('Right-eye Responses')\n    ylabel('Response')\n    xlabel('Angle of Stimulus')\n    \n\n\n\n\n\n\n\n\n(a) Synaptic weights where black denotes weak weights and white denotes strone weights. A clear preference for oriented stimuli can be seen.\n\n\n\n\n\n\n\n(b) BCM modification threshold over time. The value converges to nearly the same level for all neurons.\n\n\n\n\n\n\n\n\n\n(c) Responses to Oriented Stimuli after training. Each neuron develops orientation selectivity to a range of optimum angles.\n\n\n\n\nFigure 3.2: Simulation of 5 neurons receiving identical natural image patterns into the left- and right-input channels.\n\n\n\n\n\n\n\nBienenstock, E. L., L. N Cooper, and P. W. Munro. 1982. “Theory for the Development of Neuron Selectivity: Orientation Specificity and Binocular Interaction in Visual Cortex.” Journal of Neuroscience 2: 32–48.\n\n\nBlais, B. S., N. Intrator, H. Shouval, and L. N Cooper. 1998. “Receptive Field Formation in Natural Scene Environments: Comparison of Single Cell Learning Rules.” Neural Computation 10 (7): 1797–1813.\n\n\nBlais, Brian S. 1998. “The Role of the Environment in Synaptic Plasticity:\ntowards an Understanding of Learning and Memory.” PhD thesis, Brown University, Institute for Brain; Neural Systems; Dr. Leon N Cooper, Thesis Supervisor.\n\n\nBlais, Brian S, Mikhail Y Frenkel, Scott R Kuindersma, Rahmat Muhammad, Harel Z Shouval, Leon N Cooper, and Mark F Bear. 2008. “Recovery from Monocular Deprivation Using Binocular Deprivation.” J Neurophysiol 100 (4): 2217–24. https://doi.org/10.1152/jn.90411.2008."
  },
  {
    "objectID": "Deficit Models.html",
    "href": "Deficit Models.html",
    "title": "4  Models of Development of Amblyopia",
    "section": "",
    "text": "Code\n%matplotlib inline\nfrom input_environment_defs import *\nAmblyopia is a reduction of the best-corrected visual acuity (BCVA) with an otherwise normal eye and has many causes(Wallace et al. 2018). Two of the most common forms of amblyopia are strabismic and anisometropic amblyiopia. Strabismic amblyopia occurs when the inputs from each eye do not converge and the fixating eye becomes dominant over a non-fixating eye. Refractive amblyopia occurs with untreated unilateral refractive errors, one kind being anisometropic amblyopia where unequal refractive power in each eye leads the retinal image from the amblyopic eye to be blurred relative to the fellow eye. Both of these processes lead to synaptic plasticity adjustments and interocular competition, enhancing the initial deficit.\nIn this work we use a model of the amblyopic deficit caused by two mechanisms. The first is a blurring of the amblyopic eye inputs, representing refractive amblyopia. The second is eye-jitter, representing one source of strabismic amblyopia. We can explore these mechanisms independently and in conjunction to see how they respond differentially to the various treatments."
  },
  {
    "objectID": "Deficit Models.html#refractive-amblyopia",
    "href": "Deficit Models.html#refractive-amblyopia",
    "title": "4  Models of Development of Amblyopia",
    "section": "4.1 Refractive amblyopia",
    "text": "4.1 Refractive amblyopia\nThe amblyopic eye is presented with image patches that have been blurred with a normalized Gaussian filter applied to the images with a specified width. The larger the width the blurrier the resulting filtered image.\n\n\nCode\nsim,X=get_input_patch_examples(blur=2.5)\nims=inputs_to_images(X,buffer=2)\nfigure(figsize=(20,6))\nfor i in range(24):\n    im=ims[i]\n    subplot(4,6,i+1)\n    imshow(im,cmap=plt.cm.gray)\n    axis('off')\n    \n\n\n\n\n\nFigure 4.1: A sample of 24 input patches from a refractive amblyopic environment. The amblyopic (blurred) input is the square on the left-hand side of each pair."
  },
  {
    "objectID": "Deficit Models.html#strabismic-amblyopia",
    "href": "Deficit Models.html#strabismic-amblyopia",
    "title": "4  Models of Development of Amblyopia",
    "section": "4.2 Strabismic amblyopia",
    "text": "4.2 Strabismic amblyopia\nStrabismic inputs are modeled by changing the center of the left- and right-input patches in a systematic way, with a set mean offset and a standard deviation per input patch generated. In this way we can model completely overlapping (i.e. normal) inputs, completely non-overlapping (i.e. extreme strabismus), and any amount of overlap in between. Some examples are shown in Figure 4.2 with the offset locations shown in Figure 4.3.\n\n\nCode\nmu_r,mu_c=2,10\nsigma_r,sigma_c=1,2\n\nsim,X=get_input_patch_examples_with_jitter(blur=-1,mu_r=mu_r,mu_c=mu_c,sigma_r=sigma_r,sigma_c=sigma_c)\nims=inputs_to_images(X,buffer=2)\nfigure(figsize=(20,6))\nfor i in range(24):\n    im=ims[i]\n    subplot(4,6,i+1)\n    imshow(im,cmap=plt.cm.gray)\n    axis('off')\n    \n\n\n\n\n\nFigure 4.2: A sample of 24 input patches from a strabismic visual environment achieved through random jitter of the amblyopic (left) eye.\n\n\n\n\n\n\nCode\nimport matplotlib.patches as patches\nca=sim.monitors['ca'].array()\nra=sim.monitors['ra'].array()\nc=sim.monitors['c'].array()\nr=sim.monitors['r'].array()\n\nca_1=sim.monitors['ca_1'].array()\nra_1=sim.monitors['ra_1'].array()\nc_1=sim.monitors['c_1'].array()\nr_1=sim.monitors['r_1'].array()\n\nfigure(figsize=(11,9))\nplot(ca-c,-(ra-r),'bo',label='Left')\n\nplot(ca_1-c_1,-(ra_1-r_1),'ro',label='Right')\nrect = patches.Rectangle((-19/2, -19/2), 19, 19, linewidth=1, edgecolor='b',lw=2, facecolor='gray',alpha=0.5)\ngca().add_patch(rect)\nrect = patches.Rectangle((-19/2+mu_c, -19/2-mu_r), 19, 19, linewidth=1, edgecolor='r', lw=2,facecolor='gray',alpha=0.5)\ngca().add_patch(rect)\naxis('equal');\n\nxlabel('Horizontal Visual Field Location (pixels)')\nylabel('Vertical Visual Field Location (pixels)');\nlegend();\n\n\n\n\n\nFigure 4.3: Locations of the center of the left- and right-field of view receptive fields, jittered randomly with set mean and standard deviation. The average receptive fields are shown as gray squares.\n\n\n\n\n\n\n\n\nWallace, David K, Michael X Repka, Katherine A Lee, Michele Melia, Stephen P Christiansen, Christie L Morse, and Derek T Sprunger. 2018. “Amblyopia Preferred Practice Pattern.” Ophthalmology 125 (1): P105–42."
  },
  {
    "objectID": "Treatment Models.html",
    "href": "Treatment Models.html",
    "title": "5  Models of Treatments for Amblyopia",
    "section": "",
    "text": "Code\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport plasticnet as pn\nimport process_images_hdf5 as pi5\nfrom deficit_defs import patch_treatment\nfrom input_environment_defs import get_input_patch_examples\nfrom matplotlib.pyplot import figure,xlabel,ylabel,legend,gca,plot,subplot,imshow,axis\nTo model the fix to the refractive imbalance we follow the deficit simulation with an input environment that is rebalanced, both eyes receiving nearly identical input patches (Figure 2.4). This process is a model of the application of refractive correction. Although both eyes receive nearly identical input patches, we add independent Gaussian noise to each input channel to represent the natural variation in the activity in each eye. In addition, in those cases where use employ strabismic amblyopia, the inter-eye jitter is not corrected with the refractive correction."
  },
  {
    "objectID": "Treatment Models.html#patch-treatment",
    "href": "Treatment Models.html#patch-treatment",
    "title": "5  Models of Treatments for Amblyopia",
    "section": "5.1 Patch treatment",
    "text": "5.1 Patch treatment\nThe typical patch treatment is done by depriving the strong-eye of input with an eye-patch. In the model this is equivalent to presenting the strong-eye with random noise instead of the natural image input. Competition between the left- and right-channels drives the recovery, and is produced from the difference between structured input into the weak-eye and the unstructured (i.e. noise) input into the strong eye. It is not driven by a reduction in input activity. Figure 5.1 shows sample simulation input patterns from the patched eye. Compare this to Figure 2.4 to see that the simulated patch has far less structure than the normal inputs.\n\n\n\n\n\nFigure 5.1: A sample of 24 input patches from a patched visual environment."
  },
  {
    "objectID": "Treatment Models.html#contrast-modification",
    "href": "Treatment Models.html#contrast-modification",
    "title": "5  Models of Treatments for Amblyopia",
    "section": "5.2 Contrast modification",
    "text": "5.2 Contrast modification\nA binocular approach to treatment can be produced with contrast reduction of the non-deprived channel relative to the deprived channel. Experimentally this can be accomplished with VR headsets(Xiao et al. 2020). In the model we implement this by down-scaling the normal, unblurred channel with a simple scalar multiplier applied to each pixel (Figure 4 D). The contrast difference sets up competition between the two channels with the advantage given to the weak-eye channel.\n\n\nCode\nsim,X=get_input_patch_examples(blur=-1,contrast=0.3)\nims=inputs_to_images(X,buffer=2)\nfigure(figsize=(20,6))\nfor i in range(24):\n    im=ims[i]\n    subplot(4,6,i+1)\n    imshow(im,cmap=plt.cm.gray)\n    axis('off')\n    \n\n\n\n\n\nFigure 5.2: A sample of 24 input patches from a normal visual environment with the right-channel down-scaled relative to the left."
  },
  {
    "objectID": "Treatment Models.html#dichoptic-mask",
    "href": "Treatment Models.html#dichoptic-mask",
    "title": "5  Models of Treatments for Amblyopia",
    "section": "5.3 Dichoptic Mask",
    "text": "5.3 Dichoptic Mask\nOn top of the contrast modification, we can include the application of the dichoptic mask (Figure (fig:input?) E). In this method, each eye receives a version of the input images filtered through independent masks in each channel, resulting in a mostly-independent pattern in each channel.\nIt has been observed that contrast modification combined with dichoptic masks can be an effective treatment for amblyopia(xiao2021randomized?). The motivation behind the application of the mask filter is that the neural system must use both channels to reconstruct the full image and thus may lead to enhanced recovery.\nThe dichoptic masks are constructed with the following procedure. A blank image (i.e. all zeros) is made to which is added 15 randomly sized circles with values equal to 1 (Figure (fig:dichopic_blob?)). These images are then smoothed with a Gaussian filter of a given width, \\(f\\). This width is a parameter we can vary to change the overlap between the left- and right-eye images. A high value of \\(f\\) compared with the size of the receptive field, e.g. \\(f=90\\), yields a high overlap between the patterns in the weak- and strong-eye inputs (Figure (fig:dichopic_filter_size?)). Likewise, a small value of \\(f\\), e.g. \\(f=10\\), the eye inputs are nearly independent – the patterned activity falling mostly on one of the eyes and not much to both. Finally, the smoothed images are scaled to have values from a minimum of 0 to a maximum of 1. This image-mask we will call \\(A\\), and is the left-eye mask whereas the right-eye mask, \\(F\\), is the inverse of the left-eye mask, \\(F\\equiv 1-A\\). The mask is applied to an image by multiplying the left- and right-eye images by the left- and right-eye masks, respectively, resulting in a pair of images which have no overlap at the peaks of each mask, and nearly equal overlap in the areas of the images where the masks are near 0.5 (Figure (fig:dichopic_filter_image?))."
  },
  {
    "objectID": "Treatment Models.html#atropine-treatment",
    "href": "Treatment Models.html#atropine-treatment",
    "title": "5  Models of Treatments for Amblyopia",
    "section": "5.4 Atropine treatment",
    "text": "5.4 Atropine treatment\nIn the atropine treatment for amblyopia(Glaser et al. 2002), eye-drops of atropine are applied to the strong-eye resulting in blurred vision in that eye. Here we use the same blurred filter used to obtain the deficit (possibly with a different width) applied to the strong eye (Figure (fig:input?) F). The difference in sharpness between the strong-eye inputs and the weak-eye inputs sets up competition between the two channels with the advantage given to the weak-eye.\n\n\n\n\nGlaser, Stephen R, Andrea M Matazinski, David M Sclar, Nicholas A Sala, Chrissy M Vroman, Cindy E Tanner, David R Stager, et al. 2002. “A Randomized Trial of Atropine Vs Patching for Treatment of Moderate Amblyopia in Children.” Archives of Ophthalmology 120 (3): 268–78.\n\n\nLi, Simone L, Alexandre Reynaud, Robert F Hess, Yi-Zhong Wang, Reed M Jost, Sarah E Morale, Angie De La Cruz, Lori Dao, David Stager Jr, and Eileen E Birch. 2015. “Dichoptic Movie Viewing Treats Childhood Amblyopia.” J AAPOS 19 (5): 401–5. https://doi.org/10.1016/j.jaapos.2015.08.003.\n\n\nXiao, Scott, Eric D Gaier, Malcolm L Mazow, Ann U Stout, Dean A Travers, Endri Angjeli, Hank C Wu, Gil Binenbaum, and David G Hunter. 2020. “Improved Adherence and Treatment Outcomes with an Engaging, Personalized Digital Therapeutic in Amblyopia.” Scientific Reports 10 (1): 1–8."
  },
  {
    "objectID": "Quantifying Responses.html",
    "href": "Quantifying Responses.html",
    "title": "6  Ocular Dominance Index",
    "section": "",
    "text": "Important\n\n\n\n\ndo an orientation tuning index\ndo a spatial frequency tuning index"
  },
  {
    "objectID": "Deficit Results.html",
    "href": "Deficit Results.html",
    "title": "7  Deficit and Measuring the Effectiveness of a Treatment",
    "section": "",
    "text": "Figure (fig:ODI_vs_t_fix_n1?) shows a measurement of this recovery, using the oculur dominance index described in Section (sec:ocular-dominance-index?). Balance responses result in an \\(\\text{ODI}=0\\). As the deficit is increased, so the ODI increases toward 1. After the fix, with high levels of open-eye noise, the neurons nearly all recover from much of their initial deficit – the ODI nearly returns to \\(\\text{ODI}=0\\). A simple measure of the effectiveness of the treatment is the rate of the recovery of the ODI:\n\\[\n\\text{recovery rate}=\\frac{ODI_{\\text{deficit}}-ODI_{\\text{treatment}}}{\\text{duration of treatment}}\n\\]"
  },
  {
    "objectID": "Treatment Results.html",
    "href": "Treatment Results.html",
    "title": "8  Recovery using glasses",
    "section": "",
    "text": "The “fix” treatment described in Section (sec:models-of-development-and-treatment-of-amblyopia?) and Section (sec:deficit-and-measuring-the-effectiveness-of-a-treatment?) depends on the noise level in the open eye. Figure (fig:dODI_fix_vs_noise?) shows the rate of recovery as a function of this noise. For low-noise, there is very little improvement. For large noise, \\(\\sigma_n=1\\), the rate achieves 0.14 [ODI/day]. This measure lets us compare different treatments, and determine which are the most effective under the model assumptions. Because the experimental observation is that glasses alone are only able to fully restore vision in 27% of amblyopia cases(Wallace et al. 2006), the other simulations use an open-eye noise value of \\(\\sigma_n=0.1\\)."
  },
  {
    "objectID": "Treatment Results.html#patch-treatment",
    "href": "Treatment Results.html#patch-treatment",
    "title": "8  Recovery using glasses",
    "section": "8.1 Patch Treatment",
    "text": "8.1 Patch Treatment\nAs shown in (sec:results?), increased unstructured input into the previously dominant eye increases the rate of recovery. This is a general property of the BCM learning rule and has been explored elsewhere(Blais, Shouval, and Cooper 1999).\nFigure (fig:dODI_patch_vs_noise?) shows the effect of the patch treatment as a function of the closed-eye noise. For noise levels above \\(\\sigma_n \\sim 0.4\\) the patch treatment is more effective than recovery with glasses alone. There is the danger of the patch treatment and some other treatments (see below) of causing reverse amblyopia, producing a deficit in the previously stronger eye. This will be dependent on the magnitude of the initial deficit and the amount of time for the treatment. Because the BCM learning rule works by the competition between patterns, there is no danger of causing reverse amblyopia with the fix with glasses, but there is that danger in any treatment that has an asymmetry between the strong and weak eye, favoring the weak eye, as most treatments have.\n#todo - [ ] example of reverse amblyopia"
  },
  {
    "objectID": "Treatment Results.html#atropine-treatment",
    "href": "Treatment Results.html#atropine-treatment",
    "title": "8  Recovery using glasses",
    "section": "8.2 Atropine Treatment",
    "text": "8.2 Atropine Treatment\nFigure (fig:dODI_atropine_vs_blur?) shows the recovery rates under the atropine treatment, where the strong eye is presented with a blurred, noisy version of the natural input. Like the patch treatment, the effect is increased with increasing noise level due to the competition between patterns. When the blur filter is very small, the strong-eye inputs are nearly the same as the weak-eye inputs, yielding a result much like the glasses fix. When the blur filter is larger, the atropine treatment becomes comparable to the patch treatment. The blurred inputs are no better than the patch treatment, which has only the noise input."
  },
  {
    "objectID": "Treatment Results.html#contrast-modification-and-dichoptic-masks",
    "href": "Treatment Results.html#contrast-modification-and-dichoptic-masks",
    "title": "8  Recovery using glasses",
    "section": "8.3 Contrast Modification and Dichoptic Masks",
    "text": "8.3 Contrast Modification and Dichoptic Masks\nFigure (fig:dODI_constrast?) shows the recovery rates under a binocular treatment which only involves contrast modification, where the contrast for the strong-eye is adjusted relative to the weak eye. A contrast level of 1 is normal equal-eye vision. A contrast level of 0 means that the strong-eye input is shut off entirely. We see an increased rate of recovery with a smaller contrast value, or a larger difference between the strong- and weak-eye inputs. The rate does not compare to the rate of the patch treatment, because while there is a larger difference between the strong- and weak-eye inputs for lower contrast value, the rate of change of the strong-eye weights is decreased. The patch and atropine treatments result in more competition between patterns, resulting in faster recovery times.\n#todo - [ ] discuss optimal contrast level\nFigure (fig:dODI_constrast_mask?) shows the recovery rates under a binocular treatment which includes both contrast modification and dichoptic masks. The effect of the mask is diminished as the mask filter size increases, which is expected because a larger filter size results in more overlap in the strong- and weak-eye inputs and thus less competition. Interestingly, the mask enhances the effect of contrast on the recovery rates in two ways. For low contrast value (i.e. strong- and weak-eye inputs are more different) the mask increases the recovery rate and can reach rates comparable or exceeding patch treatment. For extremely low contrast values, where nearly all of the input is coming in from the weak eye, there is possibility of causing reverse amblyopia. For high contrast value (i.e. strong- and weak-eye inputs are nearly the same), the masks not only make the recovery slower, but can even enhance the amblyopia.\n\n\n\n\nBlais, Brian, Harel Shouval, and Leon N Cooper. 1999. “The Role of Presynaptic Activity in Monocular Deprivation: Comparison of Homosynaptic and Heterosynaptic Mechanisms.” Proc. Natl. Acad. Sci. 96: 1083–87.\n\n\nWallace, DK, SA Cotter, AR Edwards, RW Beck, Pediatric Eye Disease Investigator Group, et al. 2006. “Treatment of Amblyopia with Refractive Correction Alone.” Investigative Ophthalmology & Visual Science 47 (13): 4310–10."
  },
  {
    "objectID": "Conclusions.html",
    "href": "Conclusions.html",
    "title": "Conclusions",
    "section": "",
    "text": "Now that we have a system of simulation environments to explore, we can compare to experimentally observed rates of recovery. From (Glaser et al. 2002) we have results from several visual protocols.\n\nOnly those patients are included if they had their refractive error corrected for at least 4 weeks\nIn the patching group most patients received no more than 6-8 hours of patching per day\nThe resulting improvement in the visual acuity (measured in lines) is given here:\n\n\n\n\nTime\nPatch [lines]\nAtropine [lines]\n\n\n\n\n5 weeks\n\\(+2.22 \\pm 0.2\\)\n\\(+1.37 \\pm 0.2\\)\n\n\n16 weeks\n\\(+2.94 \\pm 0.2\\)\n\\(+2.42 \\pm 0.2\\)\n\n\n24 weeks\n\\(+3.16 \\pm 0.2\\)\n\\(+2.84 \\pm 0.2\\)\n\n\n\nThis small amount of data lets us estimate the relative rates of improvement from the treatments. Since the patch treatment is only about 1/3 day, the total time for treatment would be \\(19 \\text{weeks}\\times \\frac{7 \\text{day}}{1 \\text{week}}\\times 1/3=44 \\text{day}\\) For patch treatment with the above data we have a rate of about \\(0.94 \\text{lines} / 44 \\text{day}=0.021 \\text{lines}/\\text{day}\\). Likewise, for atropine, we have a rate of about \\(1.47\\text{lines} / 133 \\text{day}=0.011 \\text{lines}/\\text{day}\\). So the patch treatment is approximately twice as fast as the atropine. Looking at Figure (fig:dODI_atropine_vs_blur?) we see that this can put a rough constraint on the parameters. For a closed-eye noise for the patch treatment of \\(\\sigma_n=0.8\\) (recovery rate ODI/day \\(\\sim 0.2\\)), the atropine treatment must have a lower noise level – we can look at the atropine parameters which yield recover rates ODI/day \\(\\sim 0.1\\)). For little blur, we need a noise level of around \\(\\sigma_n=0.6\\), but if the atropine produces a significant blur, then the noise level of those inputs must be much lower – well below \\(\\sigma_n=0.3\\) for blur filter size 6.0, for example.\nThis noise level for atropine is entirely consistent with the same open-eye noise level with the glasses “fix” discussed earlier. Here we have an independent line of argument to suggest that atropine may blur the natural input, but doesn’t change the overall spontaneous activity of neurons. Further, it suggest that there is a significant physiological different in the activity distributions between unstructure input (e.g. patch) and degraded input (e.g. atropine).\nIn this way we may hope to constrain other parameters of the model by comparing to experimental rates of recovery.\n\n\n\n\nGlaser, Stephen R, Andrea M Matazinski, David M Sclar, Nicholas A Sala, Chrissy M Vroman, Cindy E Tanner, David R Stager, et al. 2002. “A Randomized Trial of Atropine Vs Patching for Treatment of Moderate Amblyopia in Children.” Archives of Ophthalmology 120 (3): 268–78."
  },
  {
    "objectID": "References.html",
    "href": "References.html",
    "title": "References",
    "section": "",
    "text": "Bienenstock, E. L., L. N Cooper, and P. W. Munro. 1982. “Theory\nfor the Development of Neuron Selectivity: Orientation Specificity and\nBinocular Interaction in Visual Cortex.” Journal of\nNeuroscience 2: 32–48.\n\n\nBirch, Eileen E. 2013. “Amblyopia and Binocular Vision.”\nProgress in Retinal and Eye Research 33: 67–84.\n\n\nBlais, B. S., N. Intrator, H. Shouval, and L. N Cooper. 1998.\n“Receptive Field Formation in Natural Scene Environments:\nComparison of Single Cell Learning Rules.” Neural\nComputation 10 (7): 1797–1813.\n\n\nBlais, Brian S. 1998. “The Role of the Environment in Synaptic\nPlasticity:\ntowards an Understanding of Learning and Memory.” PhD thesis,\nBrown University, Institute for Brain; Neural Systems; Dr. Leon N\nCooper, Thesis Supervisor.\n\n\nBlais, Brian S, Mikhail Y Frenkel, Scott R Kuindersma, Rahmat Muhammad,\nHarel Z Shouval, Leon N Cooper, and Mark F Bear. 2008. “Recovery\nfrom Monocular Deprivation Using Binocular Deprivation.” J\nNeurophysiol 100 (4): 2217–24. https://doi.org/10.1152/jn.90411.2008.\n\n\nBlais, Brian, Harel Shouval, and Leon N Cooper. 1999. “The Role of\nPresynaptic Activity in Monocular Deprivation: Comparison of\nHomosynaptic and Heterosynaptic Mechanisms.” Proc. Natl.\nAcad. Sci. 96: 1083–87.\n\n\nGao, Tina Y., Cindy X. Guo, Raiju J. Babu, Joanna M. Black, William R.\nBobier, Arijit Chakraborty, Shuan Dai, et al. 2018. “Effectiveness\nof a Binocular Video Game Vs Placebo Video Game for Improving Visual\nFunctions in Older Children, Teenagers, and Adults with\nAmblyopia.” JAMA Ophthalmology 136 (2): 172. https://doi.org/10.1001/jamaophthalmol.2017.6090.\n\n\nGlaser, Stephen R, Andrea M Matazinski, David M Sclar, Nicholas A Sala,\nChrissy M Vroman, Cindy E Tanner, David R Stager, et al. 2002. “A\nRandomized Trial of Atropine Vs Patching for Treatment of Moderate\nAmblyopia in Children.” Archives of Ophthalmology 120\n(3): 268–78.\n\n\nHolmes, Jonathan M., Vivian M. Manh, Elizabeth L. Lazar, Roy W. Beck,\nEileen E. Birch, Raymond T. Kraker, Eric R. Crouch, et al. 2016a.\n“Effect of a Binocular iPad Game Vs Part-Time Patching in Children\nAged 5 to 12 Years with Amblyopia.” JAMA Ophthalmology\n134 (12): 1391. https://doi.org/10.1001/jamaophthalmol.2016.4262.\n\n\nHolmes, Jonathan M, Vivian M Manh, Elizabeth L Lazar, Roy W Beck, Eileen\nE Birch, Raymond T Kraker, Eric R Crouch, et al. 2016b. “A\nRandomized Trial of a Binocular iPad Game Versus Part-Time Patching in\nChildren 5 to 12 Years of Age with Amblyopia.” JAMA\nOphthalmology 134 (12): 1391.\n\n\nHubel, David H. 1995. Eye, Brain, and Vision. Scientific\nAmerican Library/Scientific American Books.\n\n\nJeon, C J, E Strettoi, and R H Masland. 1998. “The major cell populations of the mouse\nretina.” J Neurosci 18 (21): 8936–46.\n\n\nKelly, Krista R., Reed M. Jost, Lori Dao, Cynthia L. Beauchamp, Joel N.\nLeffler, and Eileen E. Birch. 2016. “Binocular iPad Game Vs\nPatching for Treatment of Amblyopia in Children.” JAMA\nOphthalmology 134 (12): 1402. https://doi.org/10.1001/jamaophthalmol.2016.4224.\n\n\nLi, Simone L, Alexandre Reynaud, Robert F Hess, Yi-Zhong Wang, Reed M\nJost, Sarah E Morale, Angie De La Cruz, Lori Dao, David Stager Jr, and\nEileen E Birch. 2015. “Dichoptic Movie Viewing Treats Childhood\nAmblyopia.” J AAPOS 19 (5): 401–5. https://doi.org/10.1016/j.jaapos.2015.08.003.\n\n\nSterling, P, M A Freed, and R G Smith. 1988. “Architecture of rod and cone circuits to the on-beta\nganglion cell.” J Neurosci 8 (2): 623–42.\n\n\nWallace, David K, Michael X Repka, Katherine A Lee, Michele Melia,\nStephen P Christiansen, Christie L Morse, and Derek T Sprunger. 2018.\n“Amblyopia Preferred Practice Pattern.”\nOphthalmology 125 (1): P105–42.\n\n\nWallace, DK, SA Cotter, AR Edwards, RW Beck, Pediatric Eye Disease\nInvestigator Group, et al. 2006. “Treatment of Amblyopia with\nRefractive Correction Alone.” Investigative Ophthalmology\n& Visual Science 47 (13): 4310–10.\n\n\nXiao, Scott, Endri Angjeli, Hank C Wu, Eric D Gaier, Stephanie Gomez,\nDean A Travers, Gil Binenbaum, et al. 2022. “Randomized Controlled\nTrial of a Dichoptic Digital Therapeutic for Amblyopia.”\nOphthalmology 129 (1): 77–85.\n\n\nXiao, Scott, Eric D Gaier, Malcolm L Mazow, Ann U Stout, Dean A Travers,\nEndri Angjeli, Hank C Wu, Gil Binenbaum, and David G Hunter. 2020.\n“Improved Adherence and Treatment Outcomes with an Engaging,\nPersonalized Digital Therapeutic in Amblyopia.” Scientific\nReports 10 (1): 1–8.\n\n\nZárate, Blanca Ruiz de, and Jaime Tejedor. 2007. “Current Concepts\nin the Management of Amblyopia.” Clinical Ophthalmology\n(Auckland, NZ) 1 (4): 403."
  }
]